<script setup>
import HttpRequest from '@/Api/ApiConfig';
import Loading from '@/components/Loading.vue';
import { ref } from 'vue';


let props = defineProps({
    type: Number,
    data: Object
})

let isLoading = ref(false)

let download = () => {
    if (!isLoading.value) {
        isLoading.value = true
        HttpRequest.post(`/download/movie/${props.data.id}`)
            .then(res => {
                isLoading.value = false
                if (res != undefined) {
                    // window.open(res.data, '_blank');
                    window.location.href = res.data
                }
            })
            .catch(err => isLoading.value = false)
    }
}

</script>

<template>
    <div :class="{
        'LinkSection': true,
        'type-0': type == 0,
        'type-1': type == 1,
        'type-2': type == 2,
    }">
        <div class="right_detail">
            <div class="downloadButton" @click="download">
                <Loading v-if="isLoading" />
                <svg class="icon receive_square_icon" v-if="!isLoading">
                    <use xlink:href="#receive_square">
                        <symbol viewBox="0 0 100 100" id="receive_square">
                            <path
                                d=" M 33.27 5.31 C 43.85 5.17 54.43 5.28 65.01 5.26 C 72.87 5.45 81.36 7.13 87.15 12.85 C 92.63 18.37 94.39 26.44 94.72 33.96 C 94.79 44.32 94.74 54.68 94.74 65.04 C 94.56 72.68 92.97 80.86 87.63 86.66 C 82.12 92.52 73.75 94.39 66.00 94.72 C 55.65 94.79 45.29 94.74 34.94 94.74 C 27.09 94.56 18.61 92.86 12.83 87.14 C 7.35 81.59 5.60 73.51 5.28 65.97 C 5.21 55.64 5.26 45.30 5.26 34.97 C 5.45 27.34 7.03 19.16 12.35 13.36 C 17.68 7.66 25.75 5.74 33.27 5.31 M 26.40 12.62 C 22.14 13.57 18.01 15.83 15.55 19.52 C 12.48 24.01 11.79 29.63 11.51 34.93 C 11.49 44.97 11.49 55.01 11.51 65.05 C 11.79 71.25 12.79 78.07 17.36 82.68 C 21.98 87.22 28.79 88.21 34.98 88.49 C 45.00 88.51 55.02 88.51 65.04 88.49 C 71.24 88.22 78.03 87.20 82.68 82.68 C 87.19 78.04 88.22 71.25 88.49 65.05 C 88.51 55.03 88.51 45.01 88.49 34.99 C 88.22 28.79 87.22 21.97 82.67 17.35 C 78.06 12.80 71.27 11.79 65.08 11.51 C 55.71 11.47 46.33 11.53 36.95 11.49 C 33.41 11.45 29.85 11.81 26.40 12.62 Z">
                            </path>
                            <path
                                d=" M 47.09 25.97 C 47.85 23.43 51.13 23.65 52.84 25.13 C 53.74 34.25 53.02 43.45 53.25 52.61 C 55.93 50.14 58.22 47.22 61.17 45.06 C 63.91 43.47 67.18 47.50 64.97 49.79 C 60.44 54.42 55.97 59.16 51.14 63.48 C 50.57 63.48 49.44 63.48 48.87 63.48 C 44.20 59.39 40.00 54.75 35.56 50.40 C 32.56 48.35 35.70 43.16 38.91 45.11 C 41.91 47.35 44.26 50.33 47.00 52.86 C 47.07 43.90 46.87 34.93 47.09 25.97 Z">
                            </path>
                        </symbol>
                    </use>
                </svg>
                {{ !isLoading ? 'دانلود با لینک مستقیم' : '' }}
            </div>
            <p class="alert_link" v-if="data.alert">
                <svg class="icon info_icon">
                    <use xlink:href="#info">
                        <symbol viewBox="0 0 512 512" id="info">
                            <path
                                d=" M 248.40 0.00 L 263.55 0.00 C 297.20 1.20 330.69 8.60 361.36 22.58 C 414.89 46.63 459.50 89.76 485.48 142.36 C 501.91 175.25 510.69 211.74 512.00 248.43 L 512.00 263.52 C 510.62 302.39 500.84 341.05 482.49 375.40 C 463.60 411.28 436.01 442.55 402.77 465.78 C 361.99 494.63 312.54 510.65 262.65 512.00 L 249.42 512.00 C 210.22 510.83 171.25 500.92 136.58 482.50 C 97.11 461.64 63.20 430.34 39.43 392.54 C 14.89 354.18 1.52 309.04 0.00 263.59 L 0.00 248.44 C 0.54 238.27 1.24 228.10 2.80 218.03 C 9.72 170.76 30.35 125.63 61.57 89.47 C 75.71 72.94 91.98 58.22 109.84 45.81 C 150.22 17.36 199.10 1.61 248.40 0.00 M 250.53 134.69 C 239.18 136.44 228.43 145.97 228.39 157.99 C 228.30 170.28 239.24 180.20 250.88 181.94 C 263.72 184.43 278.36 177.08 282.34 164.26 C 284.86 156.63 282.15 148.00 276.50 142.48 C 269.84 135.76 259.76 133.01 250.53 134.69 M 245.45 214.57 C 238.42 216.12 230.29 220.82 230.10 228.89 C 230.01 271.61 230.07 314.34 230.07 357.07 C 229.91 363.39 235.33 368.09 240.61 370.55 C 251.12 375.30 264.02 374.89 274.03 369.06 C 278.28 366.49 282.46 362.33 282.28 356.99 C 282.30 314.66 282.29 272.34 282.29 230.01 C 282.67 224.10 278.10 219.31 273.07 216.97 C 264.54 212.93 254.57 212.60 245.45 214.57 Z">
                            </path>
                        </symbol>
                    </use>
                </svg>
                <span>{{ data.alert }}</span>
            </p>
        </div>
        <div class="left_detail">
            <p class="resoultion">
                {{ data.resolution }}
                <svg class="icon tvres_icon">
                    <use xlink:href="#tvres">
                        <symbol viewBox="0 0 20 19" id="tvres">
                            <path
                                d="M2.00004 13H18V2H2.00004V13ZM11 15V17H15V19H5.00004V17H9.00004V15H0.992041C0.860727 14.9992 0.730858 14.9725 0.609879 14.9215C0.488899 14.8704 0.379188 14.7959 0.287032 14.7024C0.194877 14.6088 0.122089 14.498 0.0728414 14.3763C0.0235937 14.2546 -0.00114581 14.1243 4.07459e-05 13.993V1.007C4.07459e-05 0.451 0.455041 0 0.992041 0H19.008C19.556 0 20 0.449 20 1.007V13.993C20 14.549 19.545 15 19.008 15H11Z">
                            </path>
                        </symbol>
                    </use>
                </svg>
            </p>
            <p class="disk">{{ data.disk }}</p>
            <div class="subtitle">{{ data.subtitle }}</div>
            <p class="quality">
                {{ data.quality }}
                <span>Encoder : {{ data.Encoder }}</span>
            </p>
        </div>
    </div>
</template>

<style scoped>
@import '@/assets/css/views/Movie/navbar/download/MovieDownload/Link.css';
</style>